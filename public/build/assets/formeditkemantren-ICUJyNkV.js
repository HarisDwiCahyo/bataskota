import{V as ie,f as se,M as Se,T,O as Ge,X as U,L as ce,G as ke,N as ne,R as Fe,b as S,c as G,S as C,e as h,d as v,Q as Me,a as Pe,g as ze,h as Te,i as Ne,j as E,D as xe,k as ue,l as De,F as de,C as ee,P as oe,m as Oe,n as je,o as Ae,p as me,q as He,r as Ve}from"./GeoJSON-C5wKpImO.js";import{g as We}from"./t-wkt.esm-CtkApKJt.js";import{G as qe}from"./Geolocation-DOMlNKP2.js";import{M as Re,S as Ze}from"./Snap-CkQZeV6i.js";import{W as _e}from"./WKT-BIzRGbMv.js";var k=new ie({center:se([110.35385111973005,-7.791739623962835]),zoom:18,projection:"EPSG:4326"}),t=new Se({target:"map",view:k,controls:[]}),$e=new T({title:"Open Street Map",visible:!0,source:new Ge}),Ke=new T({title:"Esri Maps",visible:!0,source:new U({attributions:["Tiles © Esri"],url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"})}),Je=new T({title:"World Street Map",visible:!0,source:new U({attributions:["Tiles © Esri"],url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"})}),Xe=new T({title:"World Imagery Map",visible:!0,source:new U({attributions:["Tiles © Esri"],url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})}),Qe=new ce({title:"BaseMaps",layers:[Ke,$e,Je,Xe]});t.addLayer(Qe);var Y=new ce({title:"Group",layers:[]});t.addLayer(Y);function Ye(e,n){n.getFeatures().forEach(function(u){u.un("modifyend",i)});var o=new Re({source:n});e.addInteraction(o);var a=new Ze({source:n});e.addInteraction(a),o.on("modifyend",i);function i(u){document.getElementById("geom").value="";var r=u.features.item(0),d=r.getGeometry(),W=new _e().writeGeometry(d);document.getElementById("geom").value=W}}$.getJSON("/admin/kecamatan",function(e){var n=data[0].gid,o=e.data.features.find(function(Z){return Z.properties.gid===n});if(!o){console.error("Polygon dengan gid target tidak ditemukan.");return}var a=new ke,i=a.readFeature(o,{featureProjection:"EPSG:3857"}),u=a.readFeature(o,{featureProjection:"EPSG:4326"}),r=i.getGeometry().getExtent(),d=500,W=ne(r,d),fe=e.data.features.filter(function(Z){var Be=a.readFeature(Z,{featureProjection:"EPSG:3857"});return Fe(W,Be.getGeometry().getExtent())}),ye={type:"FeatureCollection",features:fe},we=a.readFeatures(ye,{featureProjection:"EPSG:4326"}),Ee=new S({features:we}),he=new G({title:"Polygon Buffer",source:Ee,style:new C({stroke:new h({color:"blue",width:2}),fill:new v({color:"rgba(0, 0, 255, 0.1)"})})});Y.getLayers().push(he);var q=new S({features:[u]}),Ce=new G({title:"Polygon Target",source:q,style:new C({stroke:new h({color:"yellow",width:3}),fill:new v({color:"rgba(255, 255, 0, 0.3)"})})});Y.getLayers().push(Ce);var te=q.getExtent(),Le=ne(te,Me(te)*.1);t.getView().fit(Le,{duration:1e3,maxZoom:19}),Ye(t,q);var R=document.getElementById("geom");R.addEventListener("input",function(){R.value});var be=o.geometry,Ie=We(be);R.value=Ie});const Ue=new Pe({tipLabel:"Show Layers",groupSelectStyle:"children",collapseTipLabel:"Collapse layers"});t.addControl(Ue);var et=new ze({className:"mousePosition",projection:"EPSG:4326",coordinateFormat:function(e){return Te(e,"{y} , {x}",6)}});t.addControl(et);var tt=new Ne({target:"custom-scale-line",text:!0,bar:!0});t.addControl(tt);var c=document.createElement("div");c.className="toolbarDiv";var b=document.createElement("button");b.innerHTML='<span class="icon"><i class="icon-home"></i></span>';b.className="myButton";b.title="Home";var N=document.createElement("div");N.className="homeButtonDiv";N.appendChild(b);c.appendChild(N);var nt=new E({element:N});b.addEventListener("click",()=>{ge(),t.setView(new ie({center:se([110.35385111973005,-7.791739623962835]),zoom:18}))});t.addControl(nt);let I=document.createElement("button");I.innerHTML='<span class="icon"><i class="icon-enlarge"></i></span>';I.className="myButton";I.title="FullScreen";var x=document.createElement("div");x.className="fsButtonDiv";x.appendChild(I);c.appendChild(x);let ot=new E({element:x});I.addEventListener("click",()=>{let e=document.getElementById("map");e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()});t.addControl(ot);let g=document.createElement("button");g.innerHTML='<span class="icon"><i class="icon-hand"></i></span>';g.className="myButton";g.id="panButton";g.title="Pan";let D=document.createElement("div");D.className="panButtonDiv";D.appendChild(g);c.appendChild(D);let at=new E({element:D}),_=!1,ae=new xe;g.addEventListener("click",()=>{g.classList.toggle("clicked"),_=!_,_?(document.getElementById("map").style.cursor="grab",t.addInteraction(ae)):(document.getElementById("map").style.cursor="default",t.removeInteraction(ae))});t.addControl(at);var F=new ue;F.on("boxend",function(){var e=F.getGeometry().getExtent();t.getView().fit(e)});var p=document.createElement("button");p.innerHTML='<span class="icon"><i class="icon-zoom-in"></i></span>';p.className="myButton";p.id="ziButton";p.title="ZoomIn";var O=document.createElement("div");O.className="ziButtonDiv";O.appendChild(p);c.appendChild(O);var rt=new E({element:O}),K=!1;p.addEventListener("click",()=>{p.classList.toggle("clicked"),K=!K,K?(document.getElementById("map").style.cursor="zoom-in",t.addInteraction(F)):(t.removeInteraction(F),document.getElementById("map").style.cursor="default")});t.addControl(rt);var M=new ue;M.on("boxend",function(){var e=M.getGeometry().getExtent();t.getView().setCenter(De(e)),k.setZoom(k.getZoom()-1)});var f=document.createElement("button");f.innerHTML='<span class="icon"><i class="icon-zoom-out"></i></span>';f.className="myButton";f.id="zoButton";f.title="Zoom Out";var j=document.createElement("div");j.className="zoButtonDiv";j.appendChild(f);c.appendChild(j);var lt=new E({element:j}),J=!1;f.addEventListener("click",()=>{f.classList.toggle("clicked"),J=!J,J?(document.getElementById("map").style.cursor="zoom-out",t.addInteraction(M)):(t.removeInteraction(M),document.getElementById("map").style.cursor="default")});t.addControl(lt);$("#btnCrosshair").on("click",function(e){$("#btnCrosshair").toggleClass("clicked"),$("#btnCrosshair").hasClass("clicked")?it():ge()});var ve,B=new qe({trackingOptions:{enableHighAccuracy:!0},tracking:!0,projection:k.getProjection()}),L=new de;L.setStyle(new C({image:new ee({radius:6,fill:new v({color:"#3399cc"}),stroke:new h({color:"#fff",width:2})})}));var P=new de;new G({map:t,source:new S({features:[P,L]})});function it(){var e=B.getPosition();L.setGeometry(e?new oe(e):null),P.setGeometry(B.getAccuracyGeometry()),e&&t.getView().animate({center:e,zoom:16,duration:1e3}),ve=setInterval(function(){var n=B.getPosition(),o=B.getAccuracyGeometry();L.setGeometry(n?new oe(n):null),P.setGeometry(o),n&&t.getView().animate({center:n,duration:1e3})},1e4)}function ge(){clearInterval(ve),L.setGeometry(null),P.setGeometry(null)}let y=document.createElement("button");y.innerHTML='<span class="icon"><i class="icon-ruler"></i></span>';y.className="myButton";y.id="lengthButton";y.title="Measure Length";var A=document.createElement("div");A.className="lengthButtonDiv";A.appendChild(y);c.appendChild(A);var st=new E({element:A}),X=!1;y.addEventListener("click",()=>{if(y.classList.toggle("clicked"),X=!X,document.getElementById("map").style.cursor="default",X)t.removeInteraction(s),pe("LineString");else{t.removeInteraction(s),V.clear();const e=document.getElementsByClassName("ol-tooltip ol-tooltip-static");for(;e.length>0;)e[0].remove()}});t.addControl(st);let w=document.createElement("button");w.innerHTML='<span class="icon"><i class="icon-straighten"></i></span>';w.className="myButton";w.id="areaButton";w.title="Measure Area";var H=document.createElement("div");H.className="areaButtonDiv";H.appendChild(w);c.appendChild(H);var ct=new E({element:H}),Q=!1;w.addEventListener("click",()=>{if(w.classList.toggle("clicked"),Q=!Q,document.getElementById("map").style.cursor="default",Q)t.removeInteraction(s),pe("Polygon");else{t.removeInteraction(s),V.clear();const e=document.getElementsByClassName("ol-tooltip ol-tooltip-static");for(;e.length>0;)e[0].remove()}});t.addControl(ct);var s,V=new S,ut=new G({source:V,style:new C({fill:new v({color:"rgba(255, 255, 255, 0.2)"}),stroke:new h({color:"#ffcc33",width:2}),image:new ee({radius:7,fill:new v({color:"#ffcc33"})})})});t.addLayer(ut);function pe(e){s=new Oe({source:V,type:e,style:new C({fill:new v({color:"rgba(200, 200, 200, 0.6)"}),stroke:new h({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ee({radius:5,stroke:new h({color:"rgba(0, 0, 0, 0.7)"}),fill:new v({color:"rgba(255, 255, 255, 0.2)"})})})}),t.addInteraction(s),le(),dt();var n,o=function(a){a.dragging||n&&n.getGeometry()};t.on("pointermove",o),s.on("drawstart",function(a){n=a.feature;var i=a.coordinate;n.getGeometry().on("change",function(u){var r=u.target,d;r instanceof je?(d=vt(r),i=r.getInteriorPoint().getCoordinates()):r instanceof Ae&&(d=mt(r),i=r.getLastCoordinate()),l.innerHTML=d,z.setPosition(i)})}),s.on("drawend",function(){l.className="ol-tooltip ol-tooltip-static",z.setOffset([0,-7]),n=null,l=null,le()})}var m,re;function dt(){m&&m.parentNode.removeChild(m),m=document.createElement("div"),m.className="ol-tooltip hidden",re=new me({element:m,offset:[15,0],positioning:"center-left"}),t.addOverlay(re)}$(t.getViewport()).on("mouseout",function(){$(m).addClass("hidden")});var l,z;function le(){l&&l.parentNode.removeChild(l),l=document.createElement("div"),l.className="ol-tooltip  ol-tooltip-measure",z=new me({element:l,offset:[0,-15],positioning:"bottom-center"}),t.addOverlay(z)}var mt=function(e){var n=He(e,{projection:"EPSG:4326"}),o;return n>1e3?o=Math.round(n/1e3*100)/100+" km":o=Math.round(n*100)/100+" m",o},vt=function(e){var n=Ve(e,{projection:"EPSG:4326"}),o;return n>1e6?o=Math.round(n/1e6*100)/100+" km<sup>2</sup>":o=Math.round(n*100)/100+" m<sup>2</sup>",o};
